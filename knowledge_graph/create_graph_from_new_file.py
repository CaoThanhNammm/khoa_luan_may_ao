import os

from LLM import prompt
from LLM.Llama import Llama
from PreProcessing.PreProcessing import PreProcessing
from PreProcessing.ProcessingPdf import PDF
from knowledge_graph.KnowledgeGraphDatabase import Neo4j
import json
from dotenv import load_dotenv
load_dotenv()
import ast
import pandas as pd
import uuid

def clean_dict(d):
    return {k: v for k, v in d.items() if str(v) != "-1"}

if __name__ == "__main__":
    # Thay đổi thông tin kết nối theo cấu hình Neo4j của bạn
    # folder_pdf = r"D:\PycharmProjects\dataset\vmlu\vi_squad.pdf"
    uri = os.getenv("URI_LOCAL")
    user = os.getenv("USER")
    password = os.getenv("PASSWORD")
    model_llama_405b = os.getenv("MODEL_LLAMA_405B")
    model_llama_70b = os.getenv("MODEL_LLAMA_70B")
    # pre_processing = PreProcessing()
    api_key_01 =  os.getenv("API_KEY_NVIDIA_01")
    api_key_02 =  os.getenv("API_KEY_NVIDIA_02")

    # Tạo instance của class Neo4j, llama, pdf
    neo = Neo4j(uri, user, password)
    llama_title = Llama(api_key_01, model_llama_70b)
    llama_content = Llama(api_key_02, model_llama_405b)

    mag_01 = pd.read_csv(r'E:\mag\mag_01.csv')
    mag_02 = pd.read_csv(r'E:\mag\mag_02.csv')
    mag_03 = pd.read_csv(r'E:\mag\mag_03.csv')
    mag_04 = pd.read_csv(r'E:\mag\mag_04.csv')
    mag_05 = pd.read_csv(r'E:\mag\mag_05.csv')
    mag_06 = pd.read_csv(r'E:\mag\mag_06.csv')
    mag_07 = pd.read_csv(r'E:\mag\mag_07.csv')
    mag_08 = pd.read_csv(r'E:\mag\mag_08.csv')
    mag_09 = pd.read_csv(r'E:\mag\mag_09.csv')
    mag_10 = pd.read_csv(r'E:\mag\mag_10.csv')

    mag_final = pd.concat([mag_01, mag_02, mag_03, mag_04, mag_05, mag_06, mag_07, mag_08, mag_09, mag_10 ], ignore_index=True)

    for row in mag_final.itertuples(index=False):
        source = ast.literal_eval(row.source)
        relation = row.relation
        target = ast.literal_eval(row.target)
        parts = relation.split("___")
        source_type = parts[0]
        target_type = parts[2]

        source_clean = clean_dict(source)
        target_clean = clean_dict(target)

        print(f"{source_clean}:{source_type} {relation} {target_clean}:{target_type}")

        if source_clean != {} and target_clean != {}:
            neo.add_to_neo4j(source_clean, target_clean, relation, source_type, target_type)


    # pdf = PDF(folder_pdf)

    # đọc tất cả nội dung trong thư mục chứa file pdf
    # sentences = pdf.read_chunks()
    # titles = []
    # llama_title.set_prompt(prompt.create_title())
    # for s in sentences:
    #     llama_title.set_text(s)
    #     title = llama_title.generator().lower()
    #     print(title)
    #     titles.append(pre_processing.string_to_json(title))
    # print(titles)

    # tạo ra entities và relationship
    # entities_relationship = []
    # llama_content.set_prompt(prompt.extract_entities_relationship_from_text())
    # for s in sentences:
    #     llama_content.set_text(s)
    #     response = llama_content.generator().lower()
    #     entity_relation = pre_processing.string_to_json(response)
    #     entities_relationship.append(entity_relation)
    # print(entities_relationship)

    # b1: nối general với uuid người dùng(document)
    # titles = [{'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'vương tế albert, katica illényi, timelapse of the future, thomas jefferson và sega genesis'}, {'title': 'tổng hợp các chủ đề về lịch sử, công nghệ, thể thao và âm nhạc'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề về lịch sử, nghệ thuật, khoa học và thể thao'}, {'title': 'tổng hợp thông tin về các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề về phim, nghệ thuật, thể thao, hóa học và công nghệ'}, {'title': 'tổng hợp các chủ đề về khoa học, nghệ thuật, lịch sử và chính trị'}, {'title': 'kim jong-un, william shakespeare và sư tử'}, {'title': 'tổng hợp các chủ đề về khoa học, quân sự, công ty, thời trang, địa lý, chính trị và văn hóa'}, {'title': 'tóm tắt các chủ đề về phim, máy bay tàng hình, tổng thống harry s. truman và manga bleach'}, {'title': 'tổng hợp thông tin về các chủ đề khác nhau'}, {'title': 'tóm tắt về các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề về địa lý, lịch sử, khoa học và ẩm thực'}, {'title': 'tổng hợp các chủ đề về văn hóa, khoa học, âm nhạc và tôn giáo'}, {'title': 'tổng hợp các chủ đề về khoa học, văn hóa, lịch sử và giải trí'}, {'title': 'tổng quan về các nhân vật và chủ đề nổi bật'}, {'title': 'tổng hợp các chủ đề về khoa học, lịch sử, công nghệ và văn hóa'}, {'title': 'dương thu hương, stephen hawking và văn hóa nga'}, {'title': 'tổng hợp các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề văn hóa, địa lý và âm nhạc'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'f/a-18 hornet'}, {'title': 'tổng hợp thông tin về các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề lịch sử, khoa học, văn hóa và nhân vật'}, {'title': 'tổng hợp thông tin về các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề về địa lý, khoa học, lịch sử và nghệ thuật'}, {'title': 'tóm tắt về các nhân vật và sự kiện nổi bật'}, {'title': 'tổng hợp các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề về lịch sử, khoa học, nghệ thuật và văn hóa'}, {'title': 'tổng hợp các chủ đề về phim ảnh, khảo cổ học, công ty ô tô, ẩm thực, chính trị, lý thuyết kinh tế và giải thưởng'}, {'title': 'giải mercury'}, {'title': 'tổng hợp kiến thức về các chủ đề khác nhau'}, {'title': 'tổng hợp thông tin về các chủ đề khác nhau'}, {'title': 'benjamin franklin'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề về văn hóa, lịch sử, địa lý và khoa học'}, {'title': 'tổng hợp các thông tin về nhiều chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề về nghệ thuật, lịch sử, khoa học và văn hóa'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'công thức 1 và các chủ đề khác'}, {'title': 'lịch sử và phát triển của úc, nghệ thuật, điện ảnh, chiến tranh thế giới thứ nhất, y học và thể thao'}, {'title': 'tổng hợp các chủ đề khác nhau'}, {'title': 'tổng quan về các tổ chức, thành phố và nhân vật quan trọng'}, {'title': 'tổng hợp các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề về narendra modi, phương tiện truyền thông kỹ thuật số, argentina, ẩm thực châu âu, panipuri, primož roglič, hội họa và tu chính án thứ 19'}, {'title': 'tóm tắt các chủ đề khác nhau'}, {'title': 'tổng hợp các thông tin về các chủ đề khác nhau'}, {'title': 'tóm tắt các chủ đề'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề về khoa học, lịch sử và thể thao'}, {'title': 'tổng hợp thông tin về các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề'}, {'title': 'nội dung tổng hợp về các chủ đề khác nhau'}, {'title': 'tổng hợp thông tin về các chủ đề khác nhau'}, {'title': 'dune: hành tinh cát'}, {'title': 'tổng hợp thông tin về các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'nội dung tổng hợp về nhiều chủ đề'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề về văn hóa, thể thao, nghệ thuật và khoa học'}, {'title': 'tổng hợp thông tin về các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề về lịch sử, thể thao, nghệ thuật và khoa học'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề về lịch sử, văn hóa, thể thao và giải trí'}, {'title': 'tổng hợp các thông tin về nhiều chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng hợp thông tin về mumbai, sugar ray robinson, virgin hotels las vegas, toyota và nba'}, {'title': 'tổng hợp các chủ đề về thể thao, khoa học, công nghệ và chính trị'}, {'title': 'tổng hợp kiến thức về các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề về khoa học, lịch sử, văn hóa và tôn giáo'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề khoa học, lịch sử và công nghệ'}, {'title': 'tổng hợp các chủ đề về lịch sử, văn hóa, thể thao và ẩm thực'}, {'title': 'tổng hợp các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề về văn hóa, lịch sử và khoa học'}, {'title': 'tổng hợp các chủ đề về lịch sử, âm nhạc, khoa học và văn hóa'}, {'title': 'tổng hợp các chủ đề về lịch sử, khoa học và văn hóa'}, {'title': 'tổng quan về các chủ đề khoa học, văn học và động vật'}, {'title': 'tóm tắt về các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng hợp thông tin về các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề về graz, trần hưng đạo, hamburger, claude monet, en plein air và e3 2021'}, {'title': 'tổng hợp các chủ đề về văn hóa, thể thao, chính trị và tổ chức quốc tế'}, {'title': 'tổng hợp các chủ đề khác nhau'}, {'title': 'tổng quan về các nhân vật và chủ đề nổi bật'}, {'title': 'tổng hợp các chủ đề về kinh tế, khoa học, công nghệ và quân sự'}, {'title': 'tổng hợp các chủ đề về tên lửa, chính trị, thể thao, nghệ thuật, ẩm thực, y tế và công nghiệp'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề đa dạng'}, {'title': 'tổng hợp các chủ đề về khoa học, công nghệ, giải trí và thể thao'}, {'title': 'tổng hợp các chủ đề về văn hóa, lịch sử và khoa học'}, {'title': 'tổng quan về các chủ đề văn hóa, khoa học viễn tưởng và chính trị'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề đa dạng'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề về địa lý, khoa học, lịch sử và văn hóa'}, {'title': 'tổng hợp các chủ đề về văn hóa, thể thao, nghệ thuật và công nghệ'}, {'title': 'tổng hợp thông tin về các chủ đề khác nhau'}, {'title': 'sản xuất và phúc lợi kinh tế'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề đa dạng'}, {'title': 'tổng hợp thông tin về các chủ đề khác nhau'}, {'title': 'tổng quan về các nhân vật và chủ đề nổi bật'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'vũ khí hạt nhân và các chủ đề khác'}, {'title': 'rafael nadal, suy thận, kinh thánh, ký sinh trùng'}, {'title': 'tổng hợp các chủ đề về khoa học, văn hóa, địa lý và giải trí'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'nông nghiệp'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề đa dạng'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề về lịch sử, khoa học, và địa lý'}, {'title': 'tổng hợp thông tin về các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề khác nhau'}, {'title': 'tóm tắt về các chủ đề khoa học, nghệ thuật và công nghệ'}, {'title': 'tổng hợp các chủ đề về khoa học, nghệ thuật và thể thao'}, {'title': 'giới thiệu về các nhân vật và trào lưu nổi tiếng'}, {'title': 'nghệ thuật trừu tượng và các chủ đề khác'}, {'title': 'tổng hợp các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề'}, {'title': 'tổng hợp các chủ đề về lịch sử, khoa học và chính trị'}, {'title': 'tổng quan về các nhân vật và sự kiện nổi bật'}, {'title': 'tổng hợp các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề về phim, hội khoa học, giáo dục, thể thao, y tế, thức uống và nghệ thuật'}, {'title': 'tổng quan về các chủ đề đa dạng'}, {'title': 'tổng quan về các nhân vật và chủ đề nổi bật'}, {'title': 'nguyễn duy nhuệ và các chủ đề khác'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng hợp các sự kiện và thông tin về khoa học, lịch sử, văn hóa và xã hội'}, {'title': 'tổng hợp các chủ đề về lịch sử, khoa học, văn hóa và thể thao'}, {'title': 'tổng hợp các chủ đề về lịch sử, khoa học, văn hóa và thể thao'}, {'title': 'tổng hợp các chủ đề khác nhau'}, {'title': 'tổng hợp các thông tin về nhiều chủ đề'}, {'title': 'giới thiệu về các chủ đề khác nhau'}, {'title': 'tóm tắt về các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề về lịch sử, nghệ thuật, khoa học và công nghệ'}, {'title': 'tổng hợp các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'kali'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'xe điện và các chủ đề khác'}, {'title': 'tổng hợp các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề về địa lý, lịch sử, khoa học, văn hóa và thể thao'}, {'title': 'tổng hợp thông tin về các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề về nghệ thuật, lịch sử và khoa học'}, {'title': 'tổng hợp các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề về khoa học, nghệ thuật và kinh tế'}, {'title': 'tổng hợp các chủ đề về kinh tế, văn hóa và khoa học'}, {'title': 'đau thần kinh tọa'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề về lịch sử, văn hóa và khoa học'}, {'title': 'tổng hợp các chủ đề về lịch sử, văn hóa, địa lý và khoa học'}, {'title': 'tổng hợp các chủ đề về khoa học, lịch sử, văn hóa và thể thao'}, {'title': 'tổng hợp các thông tin về nhiều chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề đa dạng'}, {'title': 'tổng hợp các chủ đề về văn hóa, lịch sử, nghệ thuật và khoa học'}, {'title': 'tổng hợp thông tin về các chủ đề khác nhau'}, {'title': 'tóm tắt về các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề về lịch sử, khoa học và văn hóa'}, {'title': 'tổng hợp các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề về hóa học, lịch sử, địa lý và văn hóa'}, {'title': 'tổng hợp thông tin về các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề về thể thao, khoa học và văn hóa'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề về khoa học, văn hóa, và giải trí'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng hợp kiến thức về các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề khoa học và nghệ thuật'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng hợp thông tin về các chủ đề khác nhau'}, {'title': 'tổng hợp kiến thức về nhiều chủ đề'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề đa dạng'}, {'title': 'tổng hợp các chủ đề về văn học, lịch sử, khoa học và công nghệ'}, {'title': 'tổng hợp các chủ đề về chính trị, khoa học, văn hóa và lịch sử'}, {'title': 'tổng hợp các chủ đề về văn hóa, lịch sử, khoa học và kinh doanh'}, {'title': 'jeff bezos, trận somme, năng lượng địa nhiệt và lý thuyết sản xuất'}, {'title': 'tổng hợp kiến thức về sản xuất, nguyên tử, táo tây, phản ứng thế, john f. kennedy, tôn đức thắng, adidas, keep running'}, {'title': 'tổng hợp thông tin về các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề về địa lý, văn hóa, tôn giáo, khoa học và giải trí'}, {'title': 'tổng quan về các quốc gia và doanh nghiệp'}, {'title': 'tổng hợp các chủ đề khác nhau'}, {'title': 'tổng hợp kiến thức về các chủ đề khác nhau'}, {'title': 'thế vận hội trẻ, suy thận, dassault rafale, lockheed c-130 hercules, viêm tiền liệt tuyến, núi phú sĩ, nova scotia, đế quốc sikh'}, {'title': 'tổng quan về các chủ đề lịch sử, văn hóa và chính trị'}, {'title': 'tổng hợp các chủ đề'}, {'title': 'tổng hợp các chủ đề về văn hóa, lịch sử, khoa học và thể thao'}, {'title': 'tổng hợp các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tóm tắt về các chủ đề khác nhau'}, {'title': 'nội dung đa dạng về lịch sử, khoa học, thể thao và ẩm thực'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'âm nhạc'}, {'title': 'jennifer lawrence và các chủ đề khác'}, {'title': 'tổng hợp các chủ đề về âm nhạc, khoa học và giải thưởng'}, {'title': 'tổng hợp thông tin về các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề về địa lý, lịch sử, văn hóa và thể thao'}, {'title': 'văn miếu – quốc tử giám'}, {'title': 'tổng hợp các chủ đề về lịch sử, khoa học, văn hóa và thể thao'}, {'title': 'trận hải chiến quần đảo santa cruz'}, {'title': 'thông tin về các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề về lịch sử, văn hóa, khoa học và thể thao'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề khoa học, lịch sử và văn hóa'}, {'title': 'tổng hợp các chủ đề về văn hóa, lịch sử, khoa học và công nghệ'}, {'title': 'tóm tắt về các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề về khoa học, lịch sử, địa lý, văn hóa và ẩm thực'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề về lịch sử, văn hóa, ẩm thực và nghệ thuật'}, {'title': 'tổng hợp các chủ đề về văn hóa, khoa học, nghệ thuật và lịch sử'}, {'title': 'tổng hợp các chủ đề về ẩm thực, thể thao, lịch sử và khoa học'}, {'title': 'tổng hợp các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề về văn hóa, thể thao, âm nhạc và lịch sử'}, {'title': 'tổng quan về các chủ đề văn học, nghệ thuật và lịch sử'}, {'title': 'tổng hợp các chủ đề về lịch sử, văn hóa, kinh tế và khoa học'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề về khoa học, lịch sử, văn học và thể thao'}, {'title': 'tổng hợp các chủ đề đa dạng'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề về y học, văn hóa, lịch sử và khoa học'}, {'title': 'tổng hợp các chủ đề về lịch sử, văn hóa, khoa học và chính trị'}, {'title': 'tổng hợp các chủ đề về lịch sử, văn hóa, khoa học và thể thao'}, {'title': 'tổng hợp các thông tin về nhiều chủ đề khác nhau'}, {'title': 'ngô đình diệm'}, {'title': 'tổng hợp tin tức về các sự kiện và nhân vật nổi bật'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tình yêu, kinh tế, nghệ thuật và văn hóa'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề về lịch sử, văn hóa, khoa học và công nghệ'}, {'title': 'tổng hợp các chủ đề về văn học, ẩm thực, thể thao, khoa học và lịch sử'}, {'title': 'tổng hợp các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề lịch sử, văn hóa, nghệ thuật và khoa học'}, {'title': 'thiên tân'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề về âm nhạc, bánh ngọt, động vật, lịch sử và văn hóa'}, {'title': 'tổng hợp kiến thức về các chủ đề khác nhau'}, {'title': 'cáp nhĩ tân'}, {'title': 'tổng hợp các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề về khoa học, công nghệ, văn hóa và y tế'}, {'title': 'tổng hợp các chủ đề về khoa học, lịch sử, văn hóa và giải trí'}, {'title': 'tổng hợp thông tin về các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'giới thiệu về các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng quan về nhiều chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề về giáo dục, chính trị, thể thao và khoa học'}, {'title': 'tổng hợp các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề về khoa học, công nghệ, lịch sử và văn hóa'}, {'title': 'tổng hợp các chủ đề về văn hóa, khoa học và lịch sử'}, {'title': 'tổng hợp các chủ đề về văn hóa, lịch sử, giáo dục và âm nhạc'}, {'title': 'tổng hợp các chủ đề về âm nhạc, thể thao, địa lý và văn hóa'}, {'title': 'sarawak, unesco, liên kết pi, điện phân, nikola jokić, thuốc chống trầm cảm'}, {'title': 'tổng quan về các nhân vật và chủ đề nổi bật'}, {'title': 'tổng hợp các chủ đề về địa lý, văn hóa, lịch sử và nghệ thuật'}, {'title': 'tổng hợp các chủ đề khác nhau'}, {'title': 'stephen hawking, anime, homecoming và quản lý thông tin cá nhân'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề đa dạng'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng hợp các thông tin về các nhân vật và sự kiện nổi bật'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'giới thiệu về canada, hyundai, khoáng vật, vũ khí hạt nhân, nguyên tử, henri matisse và bệnh lao'}, {'title': 'tổng hợp các chủ đề về y tế, kinh tế, năng lượng, và địa chất'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng hợp thông tin về các chủ đề khác nhau'}, {'title': 'tổng hợp thông tin về các chủ đề khác nhau'}, {'title': 'lực lượng phòng vệ israel và các sự kiện liên quan'}, {'title': 'tổng hợp các chủ đề về lịch sử, kinh tế, văn hóa và công nghệ'}, {'title': 'tổng hợp các chủ đề về khoa học, nghệ thuật, thể thao và công nghệ'}, {'title': 'tổng hợp thông tin về các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề về nhân vật, khoa học và nghệ thuật'}, {'title': 'tổng quan về nhiều chủ đề'}, {'title': 'xe điện'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'thông tin về các quốc gia và nhân vật nổi tiếng'}, {'title': 'tóm tắt các chủ đề về tôn giáo, văn hóa, âm nhạc, thể thao và địa lý'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'ca trù'}, {'title': 'tổng hợp các chủ đề về văn hóa, lịch sử và thể thao'}, {'title': 'tổng quan về các chủ đề lịch sử, chính trị và văn hóa'}, {'title': 'tổng hợp các chủ đề về lịch sử, khoa học, văn hóa và âm nhạc'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng hợp thông tin về các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề về lịch sử, khoa học, văn hóa và giải trí'}, {'title': 'tổng hợp thông tin về các chủ đề khác nhau'}, {'title': 'tổng hợp kiến thức về các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề về nhân vật, khoa học và văn hóa'}, {'title': 'tổng hợp các chủ đề về văn hóa, khoa học và lịch sử'}, {'title': 'đế quốc songhai'}, {'title': 'tổng hợp thông tin về các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề khác nhau'}, {'title': 'trần hưng đạo'}, {'title': 'tổng hợp các chủ đề về lịch sử, khoa học, thể thao và giải trí'}, {'title': 'tổng hợp các thông tin về phim, lịch sử và khoa học'}, {'title': 'tổng hợp các chủ đề về lịch sử, văn hóa, công nghệ và y học'}, {'title': 'tổng hợp các chủ đề khác nhau'}, {'title': 'tổng hợp thông tin về các chủ đề khác nhau'}, {'title': 'tóm tắt về các nhân vật và chủ đề nổi bật'}, {'title': 'tổng hợp thông tin về các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tóm tắt về các nhân vật và sự kiện nổi bật'}, {'title': 'tổng quan về các nhân vật và sự kiện lịch sử'}, {'title': 'tổng hợp thông tin về nhiều chủ đề'}, {'title': 'tổng hợp thông tin về các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề khác nhau'}, {'title': 'trận iwo jima'}, {'title': 'tổng hợp các chủ đề khác nhau'}, {'title': 'tổng quan về các sự kiện và nhân vật lịch sử'}, {'title': 'tổng hợp các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề về ẩm thực, thể thao, y học và lịch sử'}, {'title': 'tổng hợp các chủ đề về lịch sử, khoa học, thể thao và giải trí'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'phúc lợi kinh tế và các chủ đề liên quan'}, {'title': 'tổng hợp thông tin về các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề về lịch sử, khoa học, công nghệ và thể thao'}, {'title': 'tổng hợp các chủ đề về lịch sử, nghệ thuật, khoa học và văn hóa'}, {'title': 'tổng hợp các chủ đề về kinh tế, văn hóa, thể thao và công nghệ'}, {'title': 'tổng hợp các chủ đề về khoa học, nghệ thuật và y tế'}, {'title': 'tổng hợp các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề về phim, ẩm thực, lịch sử và nhân vật'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề khoa học, lịch sử và văn hóa'}, {'title': 'tổng hợp các chủ đề về lịch sử, địa lý, thể thao và khoa học'}, {'title': 'nội dung tổng hợp về lịch sử, văn hóa, âm nhạc và địa lý'}, {'title': 'ak-74, trái đất, công ty ford motor, văn học hậu hiện đại, ivan vasilyevich panfilov, carl edward sagan'}, {'title': 'carl sagan, lễ hội bon om touk, trình minh thế, paul adrien maurice dirac, di sản thế giới của brasil, đế chế mông cổ, máy ảnh, macaron, claude monet, large hadron collider'}, {'title': 'tổng hợp các chủ đề về khoa học, công nghệ và địa lý'}, {'title': 'tổng hợp các chủ đề về văn hóa, lịch sử và địa lý'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng hợp thông tin về các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề về khoa học, văn hóa, lịch sử và thể thao'}, {'title': 'tổng hợp các chủ đề về văn hóa, lịch sử, khoa học và nghệ thuật'}, {'title': 'thông tin về các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề về địa lý, văn hóa, lịch sử và khoa học'}, {'title': 'tổng hợp các thông tin về nhiều chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề về y tế, lịch sử, chính trị, văn hóa và khoa học'}, {'title': 'tổng quan về các chủ đề đa dạng'}, {'title': 'giáo dục, y học hy lạp cổ đại, toyotomi hideyoshi, alexander zverev, ludwig boltzmann, giải thưởng âm nhạc mtv châu âu, khoáng vật học, viện bảo tàng orsay, viêm loét dạ dày - tá tràng, rối loạn ám ảnh cưỡng chế'}, {'title': 'tổng hợp các chủ đề về khoa học, lịch sử và văn hóa'}, {'title': 'tổng hợp các chủ đề về lịch sử, văn hóa, khoa học và kinh tế'}, {'title': 'tổng hợp các chủ đề về gia đình, quốc gia, phim ảnh, tôn giáo, chiến tranh và thể thao'}, {'title': 'tổng hợp các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề khoa học, nghệ thuật và thể thao'}, {'title': 'tán xạ coulomb, mansa musa, louis pasteur, galileo, thiệu trị, động cơ đốt trong'}, {'title': 'động cơ đốt trong và các chủ đề khác'}, {'title': 'tổng hợp các chủ đề khác nhau'}, {'title': 'giants của lịch sử'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề về phim, lịch sử, văn hóa và khoa học'}, {'title': 'tổng quan về các chủ đề văn hóa, nghệ thuật và công nghệ'}, {'title': 'tổng hợp các chủ đề về văn hóa, lịch sử và khoa học'}, {'title': 'nội dung tổng hợp về nhiều chủ đề'}, {'title': 'tổng quan về các nhân vật và chủ đề nổi bật'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề về khoa học, nghệ thuật và nhân vật nổi tiếng'}, {'title': 'nội dung tổng hợp'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề về khoa học, văn hóa, lịch sử và công nghệ'}, {'title': 'thông tin về các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề khác nhau'}, {'title': 'tổng hợp các thông tin về e3 2021, người đi xuyên tường, học viện chính trị quốc gia hồ chí minh, matcha, liên hiệp các hội văn học nghệ thuật việt nam, trịnh đình thảo và ký sinh trùng'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng hợp thông tin về các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tóm tắt về các chủ đề khác nhau'}, {'title': 'tổng quan về một số nhân vật và chủ đề lịch sử'}, {'title': 'tổng quan về các nhân vật và tổ chức nổi tiếng'}, {'title': 'tổng quan về các chủ đề khoa học, lịch sử, văn hóa và y học'}, {'title': 'tổng hợp các chủ đề về lịch sử, khoa học và địa lý'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng hợp các thông tin về các nhân vật và địa điểm lịch sử'}, {'title': 'tổng hợp các chủ đề về lịch sử, âm nhạc, địa lý, văn học và khoa học'}, {'title': 'tổng hợp các chủ đề khác nhau'}, {'title': 'tổng hợp các thông tin về nhiều chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng hợp kiến thức về nhiều chủ đề'}, {'title': 'tổng hợp các chủ đề về khoa học, lịch sử, văn hóa và chính trị'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề về xã hội, kinh tế, khoa học và lịch sử'}, {'title': 'tổng hợp các chủ đề về văn hóa, lịch sử, khoa học và y học'}, {'title': 'tổng hợp thông tin về các nhân vật và chủ đề nổi bật'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng quan về các chủ đề khoa học và công nghệ'}, {'title': 'liên kết pi'}, {'title': 'vắc xin, ẩm thực anh, du lịch paris, thể thao dưới mặt nước, bộ trưởng ngân khố hoa kỳ, dmitri shostakovich'}, {'title': 'tổng quan về các chủ đề khác nhau'}, {'title': 'tổng hợp các chủ đề về âm nhạc, bệnh than, in 3d, lãnh đạo tôn giáo, quốc hội và các nhân vật nổi tiếng'}, {'title': 'tổng hợp các chủ đề về người, địa điểm, sự kiện và khái niệm'}, {'title': 'nội dung về tên lửa, ngô đình diệm, antoine laurent de lavoisier, năng lượng tái tạo, lý bạch và liên minh trung tâm'}, {'title': 'liên minh trung tâm và các sự kiện lịch sử'}]
    #
    # entities_relationship = []
    # a = []
    # with open(r"D:\PycharmProjects\dataset\vmlu\entities_vi_squad.json", 'r', encoding='utf-8-sig') as f:
    #     for line in f:
    #         line = line.strip()  # loại bỏ ký tự xuống dòng
    #         if line:  # bỏ qua dòng rỗng
    #             try:
    #                 data = ast.literal_eval(line)
    #                 entities_relationship.append(data['entity_relation'])
    #             except json.JSONDecodeError as e:
    #                 print(f"Lỗi đọc JSON: {e}")
    #
    # uuid_user = 'vi_squad'
    # print(uuid_user)
    # neo.add_single_relationship("tài liệu", "General", uuid_user, "Document", "BAO_GỒM")
    # print("b1 complete")
    # # b2: nối document với tiêu đề
    # for title in titles:
    #     neo.add_single_relationship(uuid_user, "Document", title["title"], "Part", "BAO_GỒM")
    # print("b2 complete")
    # # b3: nối tiêu đề với entities_relationship
    # for r, title in zip(entities_relationship, titles):
    #     neo.import_relationships(r, title["title"], "Part")
    #
    # print("Complete!")





